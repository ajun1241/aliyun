<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.modcreater.tmdao.mapper.EventMapper">

    <sql id="Base_Column_List">
        eventId,userId,eventName,startTime,endTime,address,level,flag,
        person,person,repeatTime,isOverdue,remindTime,day,month,year
    </sql>

    <insert id="uploadingEvents" parameterType="com.modcreater.tmbeans.vo.SingleEventForDatabase">
            insert into singleevent values
            (#{eventId},
            #{userId},
            #{eventName},
            #{startTime},
            #{endTime},
            #{address},
            #{level},
            #{flag},
            #{person},
            #{remarks},
            #{repeatTime},
            #{isOverdue},
            #{remindTime},
            #{day},
            #{month},
            #{year},
            #{type})
    </insert>

    <delete id="withdrawEventsByUserId">
        delete from singleevent where id =
    </delete>

    <update id="alterEventsByUserId">
        <foreach collection="list" item="item" index="index" open="" close="" separator=";">
            update singleevent
            <set>
                userId = #{item.userId},
                eventName = #{item.eventName},
                startTime = #{item.startTime},
                endTime = #{item.endTime},
                address = #{item.address},
                level = #{item.level},
                flag = #{item.flag},
                person = #{item.person},
                remarks = #{item.remarks},
                repeatTime = #{item.repeatTime},
                isOverdue = #{item.isOverdue},
                remindTime = #{item.remindTime},
                day = #{item.day},
                month = #{item.month},
                year = #{item.year}
            </set>
            where id = ${item.id}
        </foreach>
    </update>

    <select id="queryEvents" resultType="com.modcreater.tmbeans.pojo.SingleEvent">
        select
        <include refid="Base_Column_List"/>
        from singleevent
        <where>
            <if test="userid != null">
                userid = #{userid}
            </if>
            <if test="day != null">
                and day = #{day}
            </if>
            <if test="month != null">
                and month = #{month}
            </if>
            <if test="year != null">
                and year = #{year}
            </if>
        </where>
    </select>

</mapper>
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.modcreater.tmdao.mapper.OrderMapper">

    <sql id="userOrders">
        id,userId,serviceId,orderTitle,paymentAmount,createDate,payTime,payChannel,outTradeNo,orderStatus,remark
    </sql>

    <insert id="addNewOrder">
        insert into userorders values
         (#{id},
         #{userId},
         #{serviceId},
         #{orderTitle},
         #{paymentAmount},
         #{createDate},
         null,
         null,
         null,
         0,
         #{remark})
    </insert>
    <update id="updateUserOrder">
        update userorders set
        userId = #{userId},
        serviceId = #{serviceId},
        orderTitle = #{orderTitle},
        paymentAmount = #{paymentAmount},
        createDate = #{createDate},
        payTime = #{payTime},
        payChannel = #{payChannel},
        outTradeNo = #{outTradeNo},
        orderStatus = #{orderStatus},
        remark = #{remark}
        where id = #{id}
    </update>

    <select id="getPaymentAmount" resultType="java.lang.Double">
        select
        <if test="orderType == 'month'">
            monthCardPrice
        </if>
        <if test="orderType == 'time'">
            timeCardPrice
        </if>
        <if test="orderType == 'year'">
            yearCardPrice
        </if>
        from servicefunction where id = #{serviceId}
    </select>
    <select id="getUserOrder" resultType="com.modcreater.tmbeans.pojo.UserOrders">
        select <include refid="userOrders"/> from userorders where id = #{tradeId}
    </select>
</mapper>